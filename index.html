<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>뱅크랩 API 명세서</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              mint: {
                50: '#F0F7F7',
                100: '#E6F2F2',
                200: '#D4EAEA',
                300: '#C0E1E1',
                400: '#A8CDCD',
                500: '#6EC7C7',
                600: '#52B9B9',
              },
              beige: '#F6F5F2',
              ink: '#1F2937',
              line: '#D9E3E3',
            },
            boxShadow: { soft: '0 10px 30px rgba(2, 8, 23, 0.06)' },
            fontFamily: {
              mono: [
                'ui-monospace',
                'SFMono-Regular',
                'Menlo',
                'Consolas',
                'monospace',
              ],
            },
          },
        },
      };
    </script>
    <style>
      pre.code-json {
        white-space: pre;
        word-break: normal;
        tab-size: 2;
      }
      .t-key {
        color: #f3b509;
      }
      .t-string {
        color: #07d090;
      }
      .t-number {
        color: #db2778d5;
      }
      .t-boolean {
        color: #b45309;
      }
      .t-null {
        color: #6b7280;
      }
      .t-colon {
        color: #94a3b8;
      }
      .t-punct {
        color: #94a3b8;
      }
      .t-quote {
        color: #9ca3af;
      }
    </style>
  </head>
  <body class="bg-beige text-ink">
    <!-- Header -->
    <header
      class="sticky top-0 z-40 bg-white/70 backdrop-blur border-b border-line"
    >
      <div
        class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between"
      >
        <h1 class="text-2xl font-semibold">
          <a
            href="#"
            onclick="window.location.href = window.location.pathname + window.location.search; return false;"
          >
            뱅크랩 API 명세서
          </a>
        </h1>
        <span class="text-sm text-gray-500">v1</span>
      </div>
    </header>

    <!-- Body -->
    <main
      class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 grid grid-cols-1 lg:grid-cols-12 gap-6"
    >
      <!-- Sidebar -->
      <aside class="lg:col-span-3">
        <div class="bg-white rounded-xl shadow-soft border border-line">
          <div class="p-4 border-b border-line font-medium">목차</div>
          <nav id="toc" class="p-2 space-y-1"></nav>
        </div>
      </aside>

      <!-- Content -->
      <section id="content" class="lg:col-span-9 space-y-8"></section>
    </main>

    <!-- Footer -->
    <footer class="border-t border-line bg-white/60">
      <div
        class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 text-sm text-gray-500"
      >
        © 2025 Banklab – API v1
      </div>
    </footer>

    <!-- DATA: 편집은 여기 JSON 만 바꾸세요 -->
    <script type="application/json" id="api-data">
      {
        "categories": [
          {
            "name": "계좌 관리",
            "apis": [
              {
                "id": "account-link",
                "title": "은행 계좌 연동",
                "description": "은행 로그인 정보로 계좌를 연동하고 DB에 저장합니다. CODEF API를 통해 실제 금융기관과 연결됩니다.",
                "method": "POST",
                "endpoint": "/api/account/link",
                "headers": [
                  {
                    "name": "Content-Type",
                    "value": "application/json",
                    "required": true,
                    "description": "요청 본문 JSON"
                  },
                  {
                    "name": "Authorization",
                    "value": "Bearer {token}",
                    "required": true,
                    "description": "JWT 액세스 토큰"
                  }
                ],
                "parameters": [
                  {
                    "name": "bankId",
                    "type": "string",
                    "required": true,
                    "description": "은행 로그인 아이디"
                  },
                  {
                    "name": "bankPassword",
                    "type": "string",
                    "required": true,
                    "description": "은행 로그인 비밀번호"
                  },
                  {
                    "name": "bankCode",
                    "type": "string",
                    "required": true,
                    "description": "은행 코드 (예: 0020-국민은행, 0003-기업은행, 0004-KB국민은행)"
                  }
                ],
                "requestExample": {
                  "bankId": "myBankId123",
                  "bankPassword": "myBankPassword!",
                  "bankCode": "0020"
                },
                "responses": [
                  {
                    "status": "200 OK",
                    "description": "계좌 연동 성공"
                  },
                  {
                    "status": "401 Unauthorized",
                    "description": "인증 실패 (토큰 없음/만료)"
                  },
                  {
                    "status": "500 Internal Server Error",
                    "description": "계좌 연동 중 오류 발생"
                  }
                ],
                "responseExample": {
                  "data": {
                    "accounts": [
                      {
                        "id": 1,
                        "connectedId": "abcd1234efgh5678",
                        "organization": "0004",
                        "resAccount": "12345678901234",
                        "resAccountName": "KB멋진통장",
                        "resAccountDisplay": "123456-78-901234",
                        "resAccountBalance": "548261",
                        "resAccountDeposit": "11",
                        "resAccountEndDate": "",
                        "resAccountStartDate": "20250801"
                      }
                    ],
                    "savedCount": 1,
                    "connectedId": "abcd1234efgh5678"
                  },
                  "success": true,
                  "message": "계좌 연동이 완료되었습니다.",
                  "email": "admin@example.com",
                  "memberId": 1
                },
                "curlExample": "curl -X POST https://api.banklab.app/api/account/link -H \"Content-Type: application/json\" -H \"Authorization: Bearer {token}\" -d '{\"bankId\":\"myBankId123\",\"bankPassword\":\"myBankPassword!\",\"bankCode\":\"0020\"}'"
              }
            ]
          },
          {
            "name": "계좌 거래 내역",
            "apis": [
              {
                "id": "transaction-sync",
                "title": "거래 내역 연동",
                "description": "CODEF API를 통해 계좌의 거래 내역을 조회하고 DB에 저장합니다. 비동기로 처리되며, 완료까지 시간이 소요될 수 있습니다.",
                "method": "POST",
                "endpoint": "/api/analysis/transaction-list",
                "headers": [
                  {
                    "name": "Content-Type",
                    "value": "application/json",
                    "required": true,
                    "description": "요청 본문 JSON"
                  },
                  {
                    "name": "Authorization",
                    "value": "Bearer {token}",
                    "required": true,
                    "description": "JWT 액세스 토큰"
                  }
                ],
                "parameters": [
                  {
                    "name": "organization",
                    "type": "string",
                    "required": true,
                    "description": "기관 코드 (은행 코드)"
                  },
                  {
                    "name": "connectedId",
                    "type": "string",
                    "required": true,
                    "description": "연결된 계좌의 고유 ID"
                  },
                  {
                    "name": "startDate",
                    "type": "string",
                    "required": true,
                    "description": "조회 시작일 (YYYYMMDD)"
                  },
                  {
                    "name": "endDate",
                    "type": "string",
                    "required": true,
                    "description": "조회 종료일 (YYYYMMDD)"
                  },
                  {
                    "name": "orderBy",
                    "type": "string",
                    "required": false,
                    "description": "정렬 기준 (0:과거순, 1:최신순)"
                  }
                ],
                "requestExample": {
                  "organization": "0004",
                  "connectedId": "abcd1234efgh5678",
                  "startDate": "20240101",
                  "endDate": "20240131",
                  "orderBy": "1"
                },
                "responses": [
                  {
                    "status": "200 OK",
                    "description": "거래 내역 연동 요청 성공 (비동기 처리 시작)"
                  },
                  {
                    "status": "401 Unauthorized",
                    "description": "인증 실패 (토큰 없음/만료)"
                  },
                  {
                    "status": "500 Internal Server Error",
                    "description": "거래 내역 연동 요청 중 오류 발생"
                  }
                ],
                "responseExample": {
                  "success": true,
                  "message": "거래 내역 저장이 완료되었습니다.",
                  "data": {},
                  "email": "user@example.com",
                  "memberId": 1
                },
                "curlExample": "curl -X POST https://api.banklab.app/api/analysis/transaction-list -H \"Content-Type: application/json\" -H \"Authorization: Bearer {token}\" -d '{\"organization\":\"0004\",\"connectedId\":\"abcd1234efgh5678\",\"startDate\":\"20240101\",\"endDate\":\"20240131\"}'"
              },

              {
                "id": "transaction-sync-status",
                "title": "거래 내역 연동 상태 확인",
                "description": "계좌의 거래 내역 연동 작업의 현재 상태를 확인합니다. (예: NOT_STARTED, IN_PROGRESS, COMPLETED)",
                "method": "POST",
                "endpoint": "/api/analysis/summary/status",
                "headers": [
                  {
                    "name": "Content-Type",
                    "value": "application/json",
                    "required": true,
                    "description": "요청 본문 JSON"
                  },
                  {
                    "name": "Authorization",
                    "value": "Bearer {token}",
                    "required": true,
                    "description": "JWT 액세스 토큰"
                  }
                ],
                "parameters": [
                  {
                    "name": "accountNumber",
                    "type": "string",
                    "required": true,
                    "description": "상태를 확인할 계좌번호"
                  }
                ],
                "requestExample": {
                  "accountNumber": "123-456-789"
                },
                "responses": [
                  {
                    "status": "200 OK",
                    "description": "상태 조회 성공"
                  },
                  {
                    "status": "401 Unauthorized",
                    "description": "인증 실패 (토큰 없음/만료)"
                  }
                ],
                "responseExample": {
                  "status": "COMPLETED"
                },
                "curlExample": "curl -X POST https://api.banklab.app/api/analysis/summary/status -H \"Content-Type: application/json\" -H \"Authorization: Bearer {token}\" -d '{\"accountNumber\":\"123-456-789\"}'"
              }
            ]
          },

          {
            "name": "소비 분석",
            "apis": [
              {
                "id": "transaction-summary",
                "title": "소비 내역 요약 조회",
                "description": "지정된 기간 동안의 총 수입, 총 지출 및 카테고리별 지출 내역을 요약하여 조회합니다.",
                "method": "GET",
                "endpoint": "/api/analysis/summary",
                "headers": [
                  {
                    "name": "Authorization",
                    "value": "Bearer {token}",
                    "required": true,
                    "description": "JWT 액세스 토큰"
                  }
                ],
                "parameters": [
                  {
                    "name": "start",
                    "type": "string",
                    "required": false,
                    "description": "조회 시작일 (yyyy-MM-dd)"
                  },
                  {
                    "name": "end",
                    "type": "string",
                    "required": false,
                    "description": "조회 종료일 (yyyy-MM-dd)"
                  }
                ],
                "requestExample": null,
                "responses": [
                  {
                    "status": "200 OK",
                    "description": "소비 내역 요약 조회 성공"
                  },
                  {
                    "status": "401 Unauthorized",
                    "description": "인증 실패 (토큰 없음/만료)"
                  },
                  {
                    "status": "500 Internal Server Error",
                    "description": "조회 중 오류 발생"
                  }
                ],
                "responseExample": {
                  "success": true,
                  "message": "집계 테이블 조회에 성공했습니다.",
                  "data": {
                    "summaries": {
                      "totalIncome": 5000000,
                      "totalExpense": 1250000,
                      "categorySummaries": [
                        {
                          "categoryId": 1,
                          "categoryName": "식비",
                          "totalAmount": 450000
                        },
                        {
                          "categoryId": 2,
                          "categoryName": "교통",
                          "totalAmount": 150000
                        }
                      ]
                    }
                  },
                  "email": "user@example.com",
                  "memberId": 1
                },
                "curlExample": "curl -X GET 'https://api.banklab.app/api/analysis/summary?start=2024-01-01&end=2024-01-31' -H \"Authorization: Bearer {token}\""
              },
              {
                "id": "transaction-details-by-category",
                "title": "카테고리별 상세 거래 내역 조회",
                "description": "특정 카테고리에 해당하는 상세 거래 내역 목록을 기간별로 조회합니다.",
                "method": "GET",
                "endpoint": "/api/analysis/summary/category/{categoryId}",
                "headers": [
                  {
                    "name": "Authorization",
                    "value": "Bearer {token}",
                    "required": true,
                    "description": "JWT 액세스 토큰"
                  }
                ],
                "parameters": [
                  {
                    "name": "categoryId",
                    "type": "long",
                    "required": true,
                    "description": "조회할 카테고리의 ID (Path Variable)"
                  },
                  {
                    "name": "start",
                    "type": "string",
                    "required": false,
                    "description": "조회 시작일 (yyyy-MM-dd)"
                  },
                  {
                    "name": "end",
                    "type": "string",
                    "required": false,
                    "description": "조회 종료일 (yyyy-MM-dd)"
                  }
                ],
                "requestExample": null,
                "responses": [
                  {
                    "status": "200 OK",
                    "description": "카테고리별 상세 거래 내역 조회 성공"
                  },
                  {
                    "status": "401 Unauthorized",
                    "description": "인증 실패 (토큰 없음/만료)"
                  },
                  {
                    "status": "500 Internal Server Error",
                    "description": "조회 중 오류 발생"
                  }
                ],
                "responseExample": {
                  "success": true,
                  "message": "카테고리별 거래 내역 조회에 성공했습니다.",
                  "data": {
                    "transactions": [
                      {
                        "transactionDate": "2024-01-15T14:30:00",
                        "description": "점심 식사",
                        "amount": 12000,
                        "accountNumber": "123-456-789"
                      }
                    ]
                  },
                  "email": "user@example.com",
                  "memberId": 1
                },
                "curlExample": "curl -X GET 'https://api.banklab.app/api/analysis/summary/category/1?start=2024-01-01&end=2024-01-31' -H \"Authorization: Bearer {token}\""
              },
              {
                "id": "peer-consumption-comparison",
                "title": "또래 대비 소비 패턴 비교",
                "description": "현재 로그인한 사용자의 소비 패턴을 같은 연령대의 또래 사용자들과 비교하여 분석 결과를 제공합니다.",
                "method": "GET",
                "endpoint": "/api/peer/",
                "headers": [
                  {
                    "name": "Authorization",
                    "value": "Bearer {token}",
                    "required": true,
                    "description": "JWT 액세스 토큰"
                  }
                ],
                "parameters": [
                  {
                    "name": "start",
                    "type": "string",
                    "required": false,
                    "description": "비교 분석 시작일 (yyyy-MM-dd)"
                  },
                  {
                    "name": "end",
                    "type": "string",
                    "required": false,
                    "description": "비교 분석 종료일 (yyyy-MM-dd)"
                  }
                ],
                "requestExample": null,
                "responses": [
                  {
                    "status": "200 OK",
                    "description": "또래 대비 소비 패턴 조회 성공"
                  },
                  {
                    "status": "401 Unauthorized",
                    "description": "인증 실패 (토큰 없음/만료)"
                  },
                  {
                    "status": "500 Internal Server Error",
                    "description": "조회 중 오류 발생"
                  }
                ],
                "responseExample": {
                  "success": true,
                  "message": "또래 평균을 가져오는데 성공했습니다.",
                  "data": {
                    "peer": {
                      "userAverage": 1500000.0,
                      "peerAverage": 1200000.0,
                      "categoryComparisons": [
                        {
                          "categoryName": "식비",
                          "userTotal": 600000.0,
                          "peerAverage": 500000.0
                        },
                        {
                          "categoryName": "교통",
                          "userTotal": 150000.0,
                          "peerAverage": 180000.0
                        }
                      ]
                    }
                  },
                  "email": "user@example.com",
                  "memberId": 1
                },
                "curlExample": "curl -X GET 'https://api.banklab.app/api/peer/?start=2024-07-01&end=2024-07-31' -H \"Authorization: Bearer {token}\""
              }
            ]
          }
        ]
      }
    </script>

    <!-- RENDERER -->
    <script>
      // --- Utilities ---
      function escapeHTML(str) {
        return str.replace(
          /[&<>"']/g,
          (s) =>
            ({
              '&': '&amp;',
              '<': '&lt;',
              '>': '&gt;',
              '"': '&quot;',
              "'": '&#39;',
            }[s])
        );
      }
      const IND = '  ';
      function renderJSONValue(v, depth, comma) {
        if (v === null)
          return `<span class="t-null">null</span>${comma ? ',' : ''}`;
        if (Array.isArray(v)) {
          if (!v.length)
            return `<span class="t-punct">[ ]</span>${comma ? ',' : ''}`;
          let out = `<span class="t-punct">[</span>\n`;
          v.forEach((item, i) => {
            out +=
              IND.repeat(depth + 1) +
              renderJSONValue(item, depth + 1, i !== v.length - 1) +
              '\n';
          });
          out +=
            IND.repeat(depth) +
            `<span class="t-punct">]</span>${comma ? ',' : ''}`;
          return out;
        }
        if (typeof v === 'object') {
          const keys = Object.keys(v);
          if (!keys.length)
            return `<span class="t-punct">{ }</span>${comma ? ',' : ''}`;
          let out = `<span class="t-punct">{</span>\n`;
          keys.forEach((k, i) => {
            out +=
              IND.repeat(depth + 1) +
              `<span class="t-quote">"</span><span class="t-key">${escapeHTML(
                k
              )}</span><span class="t-quote">"</span>` +
              `<span class="t-colon">: </span>` +
              renderJSONValue(v[k], depth + 1, i !== keys.length - 1) +
              '\n';
          });
          out +=
            IND.repeat(depth) +
            `<span class="t-punct">}</span>${comma ? ',' : ''}`;
          return out;
        }
        if (typeof v === 'string') {
          return `<span class="t-quote">"</span><span class="t-string">${escapeHTML(
            v
          )}</span><span class="t-quote">"</span>${comma ? ',' : ''}`;
        }
        if (typeof v === 'number')
          return `<span class="t-number">${String(v)}</span>${
            comma ? ',' : ''
          }`;
        if (typeof v === 'boolean')
          return `<span class="t-boolean">${v}</span>${comma ? ',' : ''}`;
        return `<span>${escapeHTML(v)}</span>${comma ? ',' : ''}`;
      }
      function highlightJSON(json) {
        const obj = typeof json === 'string' ? JSON.parse(json) : json;
        return renderJSONValue(obj, 0, false);
      }

      // data-json 렌더 (그대로 사용 가능)
      document.querySelectorAll('pre.code-json[data-json]').forEach((el) => {
        try {
          const raw = el.getAttribute('data-json');
          el.innerHTML = highlightJSON(raw);
          el.classList.add('font-mono', 'text-sm');
        } catch (e) {
          el.textContent = 'JSON 파싱 오류: ' + e.message;
        }
      });
      function createTable(headers, rows) {
        const table = document.createElement('table');
        table.className =
          'w-full text-sm border border-line rounded-lg overflow-hidden table-fixed';
        table.innerHTML = `
        <thead class="bg-mint-50">
          <tr>${headers
            .map(
              (h) =>
                `<th class='text-left px-3 py-2 border-b border-line'>${h}</th>`
            )
            .join('')}</tr>
        </thead>
        <tbody>${rows
          .map(
            (r) =>
              `<tr>${r
                .map(
                  (c, i) =>
                    `<td class='px-3 py-2 border-b border-line ${
                      i === 0 ? 'font-mono' : ''
                    }'>${c}</td>`
                )
                .join('')}</tr>`
          )
          .join('')}</tbody>`;
        return table;
      }

      // --- Render from JSON ---
      const data = JSON.parse(document.getElementById('api-data').textContent);
      const toc = document.getElementById('toc');
      const content = document.getElementById('content');

      data.categories.forEach((cat, ci) => {
        // Sidebar accordion
        const wrap = document.createElement('div');
        wrap.className = 'border-b border-line';
        const btn = document.createElement('button');
        btn.className =
          'w-full flex items-center justify-between px-3 py-2 hover:bg-mint-50 rounded-lg';
        btn.innerHTML = `<span class='font-medium'>${cat.name}</span><svg class='w-4 h-4 transition-transform' viewBox='0 0 20 20' fill='currentColor'><path fill-rule='evenodd' d='M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z' clip-rule='evenodd'/></svg>`;
        const list = document.createElement('div');
        list.className = 'pl-3 pb-3 hidden';
        cat.apis.forEach((api) => {
          const a = document.createElement('a');
          a.className = 'block px-3 py-1.5 rounded hover:bg-mint-50';
          a.href = `#api-${api.id}`;
          a.textContent = api.title;
          list.appendChild(a);
        });
        btn.addEventListener('click', () => {
          list.classList.toggle('hidden');
          btn.classList.toggle('acc-rot');
        });
        wrap.appendChild(btn);
        wrap.appendChild(list);
        toc.appendChild(wrap);

        // Content articles
        cat.apis.forEach((api) => {
          const art = document.createElement('article');
          art.id = `api-${api.id}`;
          art.className = 'bg-white rounded-2xl shadow-soft border border-line';
          art.innerHTML = `
          <header class='p-6 border-b border-line space-y-3'>
            <p class='text-sm text-gray-500'>${escapeHTML(cat.name)}</p>
            <h2 class='text-2xl font-semibold'>${escapeHTML(api.title)}</h2>
            ${
              api.description
                ? `<p class='text-gray-600 leading-relaxed'>${escapeHTML(
                    api.description
                  )}</p>`
                : ''
            }
            <div class='mt-4 space-y-3'>
              <div class='rounded-lg border border-line bg-mint-50/40 px-4 py-3 w-full'>
                <span class='block text-sm font-medium text-gray-500 mb-1'>HTTP Method</span>
                <span class='inline-flex items-center px-2.5 py-1 rounded-lg bg-white border border-mint-200 font-semibold'>${escapeHTML(
                  api.method
                )}</span>
              </div>
              <div class='rounded-lg border border-line bg-mint-50/40 px-4 py-3 w-full'>
                <span class='block text-sm font-medium text-gray-500 mb-1'>Endpoint</span>
                <code class='font-mono text-sm bg-white border border-mint-200 rounded px-2 py-1'>${escapeHTML(
                  api.endpoint
                )}</code>
              </div>
            </div>
          </header>
          <div class='divide-y divide-line'>
            <section class='p-6 space-y-6'>
              <h3 class='text-lg font-semibold'>Request</h3>
              <div class='space-y-6'>
                <div>
                  <h4 class='font-medium mb-2'>Headers</h4>
                  <div class='overflow-x-auto' id='tbl-h-${api.id}'></div>
                </div>
                <div>
                  <h4 class='font-medium mb-2'>Parameters (Body)</h4>
                  <div class='overflow-x-auto' id='tbl-p-${api.id}'></div>
                </div>
              </div>
              ${
                api.requestExample !== null
                  ? `<div><h4 class='font-medium mb-2'>Request Example</h4><pre class='code-json bg-beige p-4 rounded-lg border border-line overflow-x-auto' id='req-${api.id}'></pre></div>`
                  : ''
              }
            </section>
            <section class='p-6 space-y-4'>
              <h3 class='text-lg font-semibold'>Response</h3>
              <div class='space-y-2' id='reslist-${api.id}'></div>
              ${
                api.responseExample
                  ? `<div><h4 class='font-medium mb-2'>Response Example</h4><pre class='code-json bg-beige p-4 rounded-lg border border-line overflow-x-auto' id='res-${api.id}'></pre></div>`
                  : ''
              }
            </section>
            <section class='p-6 space-y-2'>
              <h3 class='text-lg font-semibold'>Example</h3>
              ${
                api.curlExample
                  ? `<pre class='bg-black text-gray-100 p-4 rounded-lg overflow-x-auto font-mono text-sm'><code>${escapeHTML(
                      api.curlExample
                    )}</code></pre>`
                  : ''
              }
            </section>
          </div>`;
          content.appendChild(art);

          // Fill tables
          const hRows = (api.headers || []).map((h) => [
            `<span class='font-mono'>${escapeHTML(h.name || '')}</span>`,
            escapeHTML(h.value || ''),
            h.required ? 'O' : 'X',
            escapeHTML(h.description || ''),
          ]);
          document
            .getElementById(`tbl-h-${api.id}`)
            .appendChild(
              createTable(
                ['Name', 'Value', 'Required', 'Description'],
                hRows.length ? hRows : [['-', '-', '-', '-']]
              )
            );

          const pRows = (api.parameters || []).map((p) => [
            `<span class='font-mono'>${escapeHTML(p.name || '')}</span>`,
            escapeHTML(p.type || ''),
            p.required ? 'O' : 'X',
            escapeHTML(p.description || ''),
          ]);
          document
            .getElementById(`tbl-p-${api.id}`)
            .appendChild(
              createTable(
                ['Name', 'Type', 'Required', 'Description'],
                pRows.length ? pRows : [['-', '-', '-', '-']]
              )
            );

          // Status list
          const resWrap = document.getElementById(`reslist-${api.id}`);
          (api.responses || []).forEach((r) => {
            const div = document.createElement('div');
            div.className =
              'border border-line rounded-lg p-4 bg-mint-50/30 flex items-start gap-3';
            div.innerHTML = `<span class='font-mono text-sm px-2 py-0.5 rounded border border-line bg-white'>${escapeHTML(
              r.status || ''
            )}</span><p class='text-sm'>${escapeHTML(r.description || '')}</p>`;
            resWrap.appendChild(div);
          });

          // JSON examples
          if (api.requestExample !== null) {
            const req = document.getElementById(`req-${api.id}`);
            req.innerHTML = highlightJSON(api.requestExample);
            req.classList.add('font-mono', 'text-sm');
          }
          if (api.responseExample) {
            const res = document.getElementById(`res-${api.id}`);
            res.innerHTML = highlightJSON(api.responseExample);
            res.classList.add('font-mono', 'text-sm');
          }
        });
      });

      // Smooth scroll
      document.addEventListener('click', (e) => {
        const a = e.target.closest('a[href^="#api-"]');
        if (!a) return;
        e.preventDefault();
        document
          .querySelector(a.getAttribute('href'))
          ?.scrollIntoView({ behavior: 'smooth', block: 'start' });
      });
    </script>
  </body>
</html>
